{include file='common/head.html'}

<div class="layui-body">
	{if([$list])}
	<div class="layui-tab layui-tab-brief" lay-filter="tab">
	  <ul class="layui-tab-title">
	    <li class="layui-this" lay-id="t1">表单列表</li>
	    <li lay-id="t2">表单新增</li>
	  </ul>
	  <div class="layui-tab-content">
	  	   <div class="layui-tab-item layui-show">
	  	   		<table class="layui-table">
	            	<thead>
	                    <tr>
	                    	<th>编码</th>
	                        <th>表单</th>
	                        <th>表名</th>
	                        <th>数据</th>
	                        <th>字段</th>
	                        <th>操作</th>
	                    </tr>
	                </thead>
	                <tbody>
	                    {foreach $forms(key,value)}
	                    <tr>
	                    	<td>[value->fcode]</td>
	                    	<td>[value->table_name]</td>
	                    	<td>[value->form_name]</td>
	                    	<td><a href="{url./admin/Form/index/fcode/'.$value->fcode.'/action/showdata}"><i class="fa fa-list"></i> 查看数据</a></td>
	                    	
	                    	<td><a href="{url./admin/Form/index/fcode/'.$value->fcode.'/action/showfield}"><i class="fa fa-pencil-square-o"></i> 编辑字段</a></td>
	                        <td>
	                        	<a href="{url./admin/Form/del/id/'.$value->id.'/action/delform}" onclick="return confirm('您确定要删除么？')" class="layui-btn layui-btn-xs layui-btn-danger" title="删除">删除</a>
	                            <a href="{url./admin/Form/mod/id/'.$value->id.'/action/modform}?backurl={URL}" class="layui-btn layui-btn-xs">修改</a>
	                        </td>
	                    </tr>
	                    {/foreach}
	                </tbody>
	            </table>
	            <div class="page">{$pagebar}</div>
	  	   </div>
	  	   
	  	    <div class="layui-tab-item">
	   			<form action="{url./admin/Form/add/action/addform}" method="post" class="layui-form">
	   				<div class="layui-form-item">
	                     <label class="layui-form-label">表单名称</label>
	                     <div class="layui-input-block">
	                     	<input type="text" name="form_name" maxlength=20 required lay-verify="required"  placeholder="请输入表单名称，如：报名表" class="layui-input">
	                     </div>
	                </div>
	                
	                <div class="layui-form-item">
	                     <label class="layui-form-label">表名称</label>
	                     <div class="layui-input-block">
	                     	<input type="text" name="table_name" maxlength=30 required lay-verify="required"  placeholder="请输入表名称，必须为字母开头，如：baoming" class="layui-input">
	                     </div>
	                </div>
	                
	   				<div class="layui-form-item">
						 <div class="layui-input-block">
						    <button class="layui-btn" lay-submit>立即提交</button>
						    <button type="reset" class="layui-btn layui-btn-primary">重置</button>
						 </div>
					</div>
	   			</form>
	   	 	</div>
	   </div>
	 </div>
	{/if} 
	
	{if([$showdata])}
	<div class="layui-tab layui-tab-brief" lay-filter="tab">
	  <ul class="layui-tab-title">
	    <li class="layui-this" lay-id="t1">{$form->form_name} — 数据</li>
	  </ul>
	  <div class="layui-tab-content">
	  	   <div class="layui-tab-item layui-show">
	  	   		{foreach $formdata(key,value,num)}
	  	   		<table class="layui-table table-two">
	  	   			<thead>
				  		<tr>
					  		<th colspan="2">{$form->form_name}-[num]</th>
					  	</tr>
				    </thead>
	  	   			<tbody>
		  	   			{foreach $fields(key2,value2,num2)}
			  	   			<tr>
						      	<th>[value2->description]</th>
						      	{php} $field=$value2->name {/php}
						      	<td>[value->$field]</td>
						    </tr>
		  	   			{/foreach}
	  	   			</tbody>
	            </table>
	            {/foreach}
	            <div class="page">{$pagebar}</div>
	            <div><a href="{url./admin/Form/index}" class="layui-btn">返回表单</a></div>
	  	   </div>
	  	 </div>
	  </div>
	{/if}  	  
	
	{if([$showfield])}
	<div class="layui-tab layui-tab-brief" lay-filter="tab">
	  <ul class="layui-tab-title">
	    <li class="layui-this" lay-id="t1">表单字段</li>
	    <li lay-id="t2">新增字段</li>
	  </ul>
	  <div class="layui-tab-content">
	  	   <div class="layui-tab-item layui-show">
	  	   		<table class="layui-table">
	            	<thead>
	                    <tr>
	                    	<th width=40>序号</th>
	                    	<th>描述</th>
	                    	<th>字段</th>
	                    	<th>排序</th>
	                        <th>类型</th>
	                        <th>操作</th>
	                    </tr>
	                </thead>
	                <tbody>
	                    {foreach $fields(key,value)}
	                    <tr>
	                    	<td>[num]</td>
	                    	<td>[value->description]</td>
	                    	<td>[value->name]</td>
	                    	<td>[value->sorting]</td>
	                    	<td>
								{if($value->type==1)}单行文本{/if}
	                    		{if($value->type==2)}多行文本{/if}
	                    		{if($value->type==3)}单选按钮{/if}
	                    		{if($value->type==4)}多选按钮{/if}
	                    		{if($value->type==5)}图片上传{/if}
	                    		{if($value->type==6)}附件上传{/if}
	                    		{if($value->type==7)}日期选择{/if}
	                    		{if($value->type==8)}编辑器{/if}
							</td>
	                        <td>
	                       		<a href="{url./admin/Form/del/id/'.$value->id.'/fcode/'.[$get.fcode].'}" onclick="return confirm('您确定要删除么？')" class="layui-btn layui-btn-xs layui-btn-danger" title="删除">删除</a>
	                            {fun=get_btn_mod($value->id)}
	                        </td>
	                    </tr>
	                    {/foreach}
	                </tbody>
	            </table>
	            <div class="page">{$pagebar}</div>
	            <div><a href="{url./admin/Form/index}" class="layui-btn">返回表单</a></div>
	  	   </div>
	  	   
	  	   <div class="layui-tab-item">
	   			<form action="{url./admin/Form/add}" method="post" class="layui-form">

	                <div class="layui-form-item">
	                     <label class="layui-form-label">字段描述</label>
	                     <div class="layui-input-block">
	                     	<input type="hidden" value="{$get.fcode}" name="fcode" >
	                     	<input type="text" name="description" required lay-verify="required"  placeholder="请输入字段描述，如：联系人" class="layui-input">
	                     </div>
	                </div>
	                
	                <div class="layui-form-item">
	                     <label class="layui-form-label">字段名称</label>
	                     <div class="layui-input-block">
	                     	<input type="text" name="name" required maxlength="20" lay-verify="required"  placeholder="请输入字段名称，如：contacts" class="layui-input">
	                     </div>
	                </div>
	                
	                <div class="layui-form-item">
	                     <label class="layui-form-label">字段排序</label>
	                     <div class="layui-input-block">
	                     	<input type="text" name="sorting" value="255" required lay-verify="required" class="layui-input">
	                     </div>
	                </div>
	                
	                <div class="layui-form-item">
	                     <label class="layui-form-label">字段类型</label>
	                     <div class="layui-input-block">
	                     	 <select name="type" lay-verify="required">
		                    	<option value="1">单行文本</option>
		                    	<option value="2">多行文本</option>
		                    	<option value="3">单选按钮</option>
		                    	<option value="4">多选按钮</option>
		                    	<option value="5">图片上传</option>
		                    	<option value="6">附件上传</option>
		                    	<option value="7">日期选择</option>
		                    	<option value="8">编辑器</option>
		                    </select>
	                     </div>
	                </div>
	                
	                <div class="layui-form-item">
	                     <label class="layui-form-label">选择按钮值</label>
	                     <div class="layui-input-block">
	                     	<textarea name="value" placeholder="多个选项用逗号隔开或者回车"  class="layui-textarea"></textarea>
	                     	<div class="layui-form-mid layui-word-aux">只在类型为单选或多选时填写有效。</div>
	                     </div>
	                </div>
	   			
	   				<div class="layui-form-item">
						 <div class="layui-input-block">
						    <button class="layui-btn" lay-submit>立即提交</button>
						    <button type="reset" class="layui-btn layui-btn-primary">重置</button>
						 </div>
					</div>
	   			</form>
	   	 	</div>
	   	 	
	   </div>
	 </div>
	{/if} 
	
	
	{if(@[$mod])}
	
	{if([$form])}
	<div class="layui-tab layui-tab-brief" lay-filter="tab">
	  <ul class="layui-tab-title">
	    <li class="layui-this">自定义表单修改</li>
	  </ul>
	  <div class="layui-tab-content">
	  	<div class="layui-tab-item layui-show">
	  		<form action="{url./admin/Form/mod/id/'.[$get.id].'/action/modform}?{$server.QUERY_STRING}" method="post" class="layui-form">
	  			<div class="layui-form-item">
                     <label class="layui-form-label">表单名称</label>
                     <div class="layui-input-block">
                     	<input type="text" name="form_name" maxlength=20 required value="{$form->form_name}" lay-verify="required"  placeholder="请输入表单名称，如：报名表" class="layui-input">
                     </div>
                </div>
                
                <div class="layui-form-item">
                     <label class="layui-form-label">表名称</label>
                     <div class="layui-input-block">
                     	<input type="text" maxlength=30 required readonly value="{$form->table_name}" lay-verify="required"  placeholder="请输入表名称，如：ay_baoming" class="layui-input readonly">
                     </div>
                </div>

   				<div class="layui-form-item">
					 <div class="layui-input-block">
					    <button class="layui-btn" lay-submit>立即提交</button>
					    <button type="reset" class="layui-btn layui-btn-primary">重置</button>
					    {fun=get_btn_back()}
					 </div>
				</div>
	  		</form>
	  	</div>
	  </div>
	 </div>
	 {/if} 
	 
	 {if(@[$field])}
	 <div class="layui-tab layui-tab-brief" lay-filter="tab">
	  <ul class="layui-tab-title">
	    <li class="layui-this">表单字段修改</li>
	  </ul>
	  <div class="layui-tab-content">
	  	<div class="layui-tab-item layui-show">
	  		<form action="{url./admin/Form/mod/id/'.[$get.id].'}?{$server.QUERY_STRING}" method="post" class="layui-form">
	  		
                <div class="layui-form-item">
                     <label class="layui-form-label">字段描述</label>
                     <div class="layui-input-block">
                     	<input type="text" name="description"  value="{$field->description}" placeholder="请输入字段描述，如：联系人" class="layui-input">
                     </div>
                </div>
                
                <div class="layui-form-item">
                     <label class="layui-form-label">字段名称</label>
                     <div class="layui-input-block">
                     	<input type="text" name="name" readonly value="{$field->name}" maxlength="30" placeholder="请输入字段名称，如：contacts" class="layui-input readonly">
                     </div>
                </div>
                
                <div class="layui-form-item">
                     <label class="layui-form-label">字段排序</label>
                     <div class="layui-input-block">
                     	<input type="text" name="sorting" value="{$field->sorting}" required lay-verify="required" class="layui-input">
                     </div>
                </div>
                
                <div class="layui-form-item">
                     <label class="layui-form-label">字段类型</label>
                     <div class="layui-input-block">
                     	 <select name="type" lay-verify="required">
	                    	{if([$field->type]==2)}
	                    		<option value="2" selected>多行文本</option>
	                    	{/if}
	                    	
	                    	{if([$field->type]==7)}
	                    		<option value="7" selected>日期选择</option>
	                    	{/if}
	                    	
	                    	{if([$field->type]==8)}
	                    		<option value="8" selected>编辑器</option>
	                    	{/if}
	                    	
	                    	{if([$field->type]!=2 && [$field->type]!=7 && [$field->type]!=8)}
	                    		<option value="1" {if([$field->type]==1)}selected{/if}>单行文本</option>
	                    		<option value="3" {if([$field->type]==3)}selected{/if}>单选按钮</option>
	                    		<option value="4" {if([$field->type]==4)}selected{/if}>多选按钮</option>
	                    		<option value="5" {if([$field->type]==5)}selected{/if}>图片上传</option>
	                    		<option value="6" {if([$field->type]==6)}selected{/if}>附件上传</option>
	                    	{/if}
	                    </select>
                     </div>
                </div>
                
                <div class="layui-form-item">
                     <label class="layui-form-label">选择按钮值</label>
                     <div class="layui-input-block">
                     	<textarea name="value" placeholder="多个选项用逗号或回车隔开"  class="layui-textarea">{$field->value}</textarea>
                     	<div class="layui-form-mid layui-word-aux">只在类型为单选或多选时填写有效，多个选项用逗号或回车隔开。</div>
                     </div>
                </div>
   			
   				<div class="layui-form-item">
					 <div class="layui-input-block">
					    <button class="layui-btn" lay-submit>立即提交</button>
					    <button type="reset" class="layui-btn layui-btn-primary">重置</button>
					    {fun=get_btn_back()}
					 </div>
				</div>
	  		</form>
	  	</div>
	  </div>
	 </div>
	 {/if} 
	 
	{/if} 
</div>
{include file='common/foot.html'}
